(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{2833:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return t(2919)}])},874:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var a=t(5893),r=t(1163),n=t(1664),l=t.n(n);function i(e){let{children:s}=e,t=(0,r.useRouter)(),n=e=>!!("/admin/dashboard"===e&&"/admin/dashboard"===t.pathname||"/admin/dashboard"!==e&&t.pathname.startsWith(e));return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-100 flex",children:[(0,a.jsxs)("aside",{className:"w-64 bg-slate-800 text-white",children:[(0,a.jsx)("div",{className:"p-4 border-b border-slate-700",children:(0,a.jsx)("h1",{className:"text-xl font-bold",children:"GeoBit Admin"})}),(0,a.jsx)("nav",{className:"p-4",children:(0,a.jsx)("ul",{className:"space-y-2",children:[{href:"/admin/dashboard",label:"Dashboard"},{href:"/admin/newsletters",label:"Newsletters"},{href:"/admin/sources",label:"Content Sources"},{href:"/admin/subscribers",label:"Subscribers"}].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:e.href,className:"block px-4 py-2 rounded-md transition duration-200 ".concat(n(e.href)?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-700"),children:e.label})},e.href))})}),(0,a.jsx)("div",{className:"p-4 mt-auto border-t border-slate-700",children:(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("geobit_admin_token"),t.push("/admin")},className:"block w-full px-4 py-2 text-left text-slate-300 hover:bg-slate-700 rounded-md transition duration-200",children:"Logout"})})]}),(0,a.jsx)("main",{className:"flex-1 p-8 overflow-auto",children:s})]})}},5218:function(e,s,t){"use strict";t.d(s,{$g:function(){return N},C7:function(){return S},Rr:function(){return k},bk:function(){return w},jA:function(){return y},kM:function(){return A},oq:function(){return C},ou:function(){return j},qp:function(){return v},sC:function(){return I}});var a=t(3977),r=t(9828),n=t(7004),l=t(3059);let i=(0,a.C6)().length?(0,a.C6)()[0]:(0,a.ZF)({apiKey:"AIzaSyDvpreQ684CJaRl0dfbhR9i_IDKz58JfMk",authDomain:"geobit-959c9.firebaseapp.com",projectId:"geobit-959c9",storageBucket:"geobit-959c9.firebasestorage.app",messagingSenderId:"518824678195",appId:"1:518824678195:web:dbd647fbe88edfd4fa6446",measurementId:"G-26LPTBX5H4"});(0,r.ad)(i);let c=(0,n.$C)(i);(0,l.Gb)().then(e=>{e&&(0,l.IH)(i)}).catch(e=>{console.error("Analytics error:",e)});let o=(0,n.V1)(c,"admin-adminLogin"),d=(0,n.V1)(c,"admin-getContentSources"),m=(0,n.V1)(c,"admin-addContentSource");(0,n.V1)(c,"admin-updateContentSource"),(0,n.V1)(c,"admin-deleteContentSource"),(0,n.V1)(c,"admin-getSubscribers");let u=(0,n.V1)(c,"admin-getApiStatus"),x=(0,n.V1)(c,"newsletter-generateNewsletterOnDemand");(0,n.V1)(c,"newsletter-publishNewsletter");let h=(0,n.V1)(c,"newsletter-getNewsletter"),b=(0,n.V1)(c,"newsletter-getNewsletters"),g=(0,n.V1)(c,"content-collectContentFromSources"),p=(0,n.V1)(c,"content-searchContentFromAI");(0,n.V1)(c,"content-getContent"),(0,n.V1)(c,"content-saveContent");let f=[{id:"dev-1",name:"Dev Source 1",url:"https://example.com/1",category:"news",active:!0},{id:"dev-2",name:"Dev Source 2",url:"https://example.com/2",category:"research",active:!0}],j=e=>!!(e&&e.startsWith("dev-admin-")),N=async e=>{try{return await o(e)}catch(s){if(console.warn("Firebase adminLogin error, using development fallback:",s),"admin123"===e.password){let e="dev-admin-"+Math.random().toString(36).substring(2,15);return{data:{success:!0,token:e}}}return{data:{success:!1,error:"Invalid password"}}}},w=async e=>{try{return await u(e)}catch(s){if(console.warn("Firebase getApiStatus error, using development fallback:",s),e.token&&j(e.token))return{data:{success:!0,status:{openRouter:{status:"ok",message:"Development mode - API simulated",quota:{used:25,limit:100,remaining:75}},firebase:{status:"ok",message:"Development mode - Firebase simulated",usage:{reads:120,writes:45,deletes:10}},email:{status:"ok",message:"Development mode - Email service simulated",quota:{used:250,limit:2e3,remaining:1750}}}}};return{data:{success:!1,error:"Unauthorized access"}}}},v=async e=>{try{return await d(e)}catch(s){if(console.warn("Firebase getContentSources error, using development fallback:",s),e.token&&j(e.token))return{data:{success:!0,sources:f}};return{data:{success:!1,error:"Unauthorized access"}}}},y=async e=>{try{return await m(e)}catch(s){if(console.warn("Firebase addContentSource error, using development fallback:",s),e.token&&j(e.token)){let s={id:"dev-"+Math.random().toString(36).substring(2,9),name:e.name,url:e.url,category:e.category||"news",active:!0};return f.push(s),{data:{success:!0,source:s}}}return{data:{success:!1,error:"Unauthorized access"}}}},k=async e=>{try{return await g(e)}catch(s){if(console.warn("Firebase collectContentFromSources error, using development fallback:",s),e.token&&j(e.token))return{data:{success:!0,message:"Content collection simulated in development mode",contentCount:5,sources:2}};return{data:{success:!1,error:"Unauthorized access"}}}},C=async e=>{try{return await p(e)}catch(s){if(console.warn("Firebase searchContentFromAI error, using development fallback:",s),e.token&&j(e.token)){await new Promise(e=>setTimeout(e,1500));let s=[{id:"dev-content-1",title:"Research on ".concat(e.query||"Geology"),source:"Development Source",url:"https://example.com/article1",publishedAt:new Date,summary:"This is a simulated summary about ".concat(e.query||"geoscience topics"," generated in development mode."),category:"research",interestScore:85},{id:"dev-content-2",title:"Latest News on ".concat(e.query||"Earth Sciences"),source:"Development Journal",url:"https://example.com/article2",publishedAt:new Date,summary:"Here's another simulated summary about ".concat(e.query||"geoscience"," for testing purposes."),category:"news",interestScore:72}];return{data:{success:!0,content:s,message:"AI search simulated in development mode"}}}return{data:{success:!1,error:"Unauthorized access"}}}},S=x,A=h,I=b;(0,n.V1)(c,"subscribers-addSubscriber")},2919:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var a=t(5893),r=t(7294),n=t(1163),l=t(9008),i=t.n(l),c=t(1664),o=t.n(c),d=t(2947),m=t(5218),u=t(3692),x=t(874),h=e=>{let{title:s,status:t,message:r,details:n}=e,{icon:l,bgColor:i,borderColor:c,textColor:o}=(()=>{switch(t){case"ok":return{icon:(0,a.jsx)(u._rq,{size:22,className:"text-green-500"}),bgColor:"bg-green-50",borderColor:"border-green-200",textColor:"text-green-700"};case"warning":return{icon:(0,a.jsx)(u.bcx,{size:22,className:"text-amber-500"}),bgColor:"bg-amber-50",borderColor:"border-amber-200",textColor:"text-amber-700"};case"error":return{icon:(0,a.jsx)(u.bcx,{size:22,className:"text-red-500"}),bgColor:"bg-red-50",borderColor:"border-red-200",textColor:"text-red-700"};default:return{icon:(0,a.jsx)(u.bax,{size:22,className:"text-gray-500"}),bgColor:"bg-gray-50",borderColor:"border-gray-200",textColor:"text-gray-600"}}})();return(0,a.jsx)("div",{className:"".concat(i," border ").concat(c," rounded-lg p-4"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"mt-1",children:l}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:s}),(0,a.jsx)("p",{className:"text-sm ".concat(o),children:r}),(()=>{if(!n)return null;if(n.quota){let e=n.quota.used/n.quota.limit*100;return(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,a.jsxs)("span",{children:[e.toFixed(1),"% used"]}),(0,a.jsxs)("span",{children:[n.quota.used," / ",n.quota.limit]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full ".concat(e>80?"bg-red-500":e>50?"bg-amber-500":"bg-green-500"),style:{width:"".concat(e,"%")}})})]})}return n.usage?(0,a.jsxs)("div",{className:"mt-2 text-xs space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Reads:"}),(0,a.jsx)("span",{className:"font-medium",children:n.usage.reads})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Writes:"}),(0,a.jsx)("span",{className:"font-medium",children:n.usage.writes})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Deletes:"}),(0,a.jsx)("span",{className:"font-medium",children:n.usage.deletes})]})]}):null})()]})]})})};function b(){let[e,s]=(0,r.useState)(!1),[t,l]=(0,r.useState)({openRouter:{status:"unknown",message:"Checking status..."},firebase:{status:"unknown",message:"Checking status..."},email:{status:"unknown",message:"Checking status..."}}),[c,b]=(0,r.useState)(!1),g=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("geobit_admin_token");if(!e){g.push("/admin");return}if(e.startsWith("dev-admin-")){console.log("Using development admin token");return}p()},[g]);let p=async()=>{b(!0);try{let e=localStorage.getItem("geobit_admin_token");try{let s=await (0,m.bk)({token:e});if(s.data.success)l(s.data.status);else throw Error(s.data.error||"Failed to fetch API status")}catch(s){console.warn("Firebase function error, using development status:",s),(0,m.ou)(e)&&l({openRouter:{status:"ok",message:"Development mode - API simulated",quota:{used:25,limit:100,remaining:75}},firebase:{status:"ok",message:"Development mode - Firebase simulated",usage:{reads:120,writes:45,deletes:10}},email:{status:"ok",message:"Development mode - Email service simulated",quota:{used:250,limit:2e3,remaining:1750}}})}}catch(e){console.error("Error checking API status:",e),d.Am.error("Failed to check API status")}finally{b(!1)}},f=async()=>{if(!e){s(!0),d.Am.info("Generating newsletter...");try{let e=localStorage.getItem("geobit_admin_token");if(!e){d.Am.error("You must be logged in as an admin"),g.push("/admin");return}try{let s=await (0,m.C7)({token:e});if(s.data.success)d.Am.success("Newsletter generated successfully!"),g.push("/admin/newsletters/edit/".concat(s.data.newsletterId));else throw Error(s.data.error||"Failed to generate newsletter")}catch(s){if(console.warn("Firebase function error, using development fallback:",s),(0,m.ou)(e))d.Am.success("Development mode: Newsletter generation simulated"),d.Am.info("Firebase Functions must be deployed for full functionality");else throw s}}catch(e){console.error("Error generating newsletter:",e),d.Am.error(e.message||"Failed to generate newsletter")}finally{s(!1)}}};return(0,a.jsxs)(x.Z,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:"Admin Dashboard - GeoBit"}),(0,a.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Dashboard"}),(0,a.jsxs)("button",{onClick:p,disabled:c,className:"flex items-center gap-2 text-sm bg-slate-200 hover:bg-slate-300 text-slate-700 font-medium py-1 px-3 rounded-md transition",children:[(0,a.jsx)(u.Bw1,{className:"".concat(c?"animate-spin":"")}),c?"Refreshing...":"Refresh Status"]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(u.nbt,{className:"mr-2"})," System Status"]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsx)(h,{title:"AI API",status:t.openRouter.status,message:t.openRouter.message,details:t.openRouter.quota}),(0,a.jsx)(h,{title:"Firebase",status:t.firebase.status,message:t.firebase.message,details:t.firebase.usage}),(0,a.jsx)(h,{title:"Email Service",status:t.email.status,message:t.email.message,details:t.email.quota})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(u.vPQ,{className:"mr-2"})," Content Management"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-b pb-4",children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Newsletter Generation"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4 text-sm",children:"Generate a new newsletter with AI-powered summaries of the latest geoscience content."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,a.jsx)("button",{onClick:f,disabled:e,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 disabled:opacity-50",children:e?"Generating...":"Generate New Newsletter"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Content Collection"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4 text-sm",children:"Search for new content or manage your content sources."}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(o(),{href:"/admin/content/collect",className:"bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 inline-block",children:"Collect New Content"}),(0,a.jsx)(o(),{href:"/admin/sources",className:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 inline-block",children:"Manage Sources"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(u.orK,{className:"mr-2"})," Analytics & Monitoring"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-b pb-4",children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Key Metrics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-slate-50 p-3 rounded-md",children:[(0,a.jsx)("p",{className:"text-slate-500 text-xs mb-1",children:"Subscribers"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:"247"})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-3 rounded-md",children:[(0,a.jsx)("p",{className:"text-slate-500 text-xs mb-1",children:"Open Rate"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:"38.2%"})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-3 rounded-md",children:[(0,a.jsx)("p",{className:"text-slate-500 text-xs mb-1",children:"Newsletters"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:"12"})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-3 rounded-md",children:[(0,a.jsx)("p",{className:"text-slate-500 text-xs mb-1",children:"Articles"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:"148"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Tools & Reports"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(o(),{href:"/admin/analytics",className:"bg-amber-600 hover:bg-amber-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 inline-block",children:"View Analytics"}),(0,a.jsx)(o(),{href:"/admin/logs",className:"bg-slate-600 hover:bg-slate-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 inline-block",children:"System Logs"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(u.WY8,{className:"mr-2"})," Audience"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-b pb-4",children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Subscriber Management"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4 text-sm",children:"View and manage your newsletter subscribers."}),(0,a.jsx)(o(),{href:"/admin/subscribers",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 inline-block",children:"Manage Subscribers"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Recent Signups"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-slate-50 rounded",children:[(0,a.jsx)("span",{className:"text-slate-700",children:"john.doe@example.com"}),(0,a.jsx)("span",{className:"text-slate-500 text-xs",children:"2 hours ago"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-slate-50 rounded",children:[(0,a.jsx)("span",{className:"text-slate-700",children:"jane.smith@university.edu"}),(0,a.jsx)("span",{className:"text-slate-500 text-xs",children:"5 hours ago"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-slate-50 rounded",children:[(0,a.jsx)("span",{className:"text-slate-700",children:"researcher@geo.org"}),(0,a.jsx)("span",{className:"text-slate-500 text-xs",children:"yesterday"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(u.JYw,{className:"mr-2"})," Archives & Publishing"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-b pb-4",children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Newsletter Archives"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4 text-sm",children:"View and edit past newsletters."}),(0,a.jsx)(o(),{href:"/admin/newsletters",className:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 inline-block",children:"View Archives"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-slate-700 mb-2",children:"Latest Newsletters"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-slate-50 rounded",children:[(0,a.jsx)("span",{className:"text-slate-700",children:"Weekly Roundup - March 13, 2025"}),(0,a.jsx)("span",{className:"bg-green-100 text-green-800 text-xs py-1 px-2 rounded-full",children:"Published"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-slate-50 rounded",children:[(0,a.jsx)("span",{className:"text-slate-700",children:"Research Highlights - March 10, 2025"}),(0,a.jsx)("span",{className:"bg-green-100 text-green-800 text-xs py-1 px-2 rounded-full",children:"Published"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm p-2 bg-slate-50 rounded",children:[(0,a.jsx)("span",{className:"text-slate-700",children:"Weekly Roundup - March 6, 2025"}),(0,a.jsx)("span",{className:"bg-green-100 text-green-800 text-xs py-1 px-2 rounded-full",children:"Published"})]})]})]})]})]})]})]})}}},function(e){e.O(0,[16,814,692,840,774,888,179],function(){return e(e.s=2833)}),_N_E=e.O()}]);