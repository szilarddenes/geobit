(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{1993:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/content/collect",function(){return s(7781)}])},874:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(5893),a=s(1163),n=s(1664),c=s.n(n);function l(e){let{children:t}=e,s=(0,a.useRouter)(),n=e=>!!("/admin/dashboard"===e&&"/admin/dashboard"===s.pathname||"/admin/dashboard"!==e&&s.pathname.startsWith(e));return(0,r.jsxs)("div",{className:"min-h-screen bg-slate-100 flex",children:[(0,r.jsxs)("aside",{className:"w-64 bg-slate-800 text-white",children:[(0,r.jsx)("div",{className:"p-4 border-b border-slate-700",children:(0,r.jsx)("h1",{className:"text-xl font-bold",children:"GeoBit Admin"})}),(0,r.jsx)("nav",{className:"p-4",children:(0,r.jsx)("ul",{className:"space-y-2",children:[{href:"/admin/dashboard",label:"Dashboard"},{href:"/admin/newsletters",label:"Newsletters"},{href:"/admin/sources",label:"Content Sources"},{href:"/admin/subscribers",label:"Subscribers"}].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:e.href,className:"block px-4 py-2 rounded-md transition duration-200 ".concat(n(e.href)?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-700"),children:e.label})},e.href))})}),(0,r.jsx)("div",{className:"p-4 mt-auto border-t border-slate-700",children:(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("geobit_admin_token"),s.push("/admin")},className:"block w-full px-4 py-2 text-left text-slate-300 hover:bg-slate-700 rounded-md transition duration-200",children:"Logout"})})]}),(0,r.jsx)("main",{className:"flex-1 p-8 overflow-auto",children:t})]})}},5218:function(e,t,s){"use strict";s.d(t,{$g:function(){return y},C7:function(){return C},Rr:function(){return S},bk:function(){return N},jA:function(){return v},kM:function(){return A},oq:function(){return k},ou:function(){return j},qp:function(){return w},sC:function(){return F}});var r=s(3977),a=s(9828),n=s(7004),c=s(3059);let l=(0,r.C6)().length?(0,r.C6)()[0]:(0,r.ZF)({apiKey:"AIzaSyDvpreQ684CJaRl0dfbhR9i_IDKz58JfMk",authDomain:"geobit-959c9.firebaseapp.com",projectId:"geobit-959c9",storageBucket:"geobit-959c9.firebasestorage.app",messagingSenderId:"518824678195",appId:"1:518824678195:web:dbd647fbe88edfd4fa6446",measurementId:"G-26LPTBX5H4"});(0,a.ad)(l);let o=(0,n.$C)(l);(0,c.Gb)().then(e=>{e&&(0,c.IH)(l)}).catch(e=>{console.error("Analytics error:",e)});let i=(0,n.V1)(o,"admin-adminLogin"),d=(0,n.V1)(o,"admin-getContentSources"),u=(0,n.V1)(o,"admin-addContentSource");(0,n.V1)(o,"admin-updateContentSource"),(0,n.V1)(o,"admin-deleteContentSource"),(0,n.V1)(o,"admin-getSubscribers");let m=(0,n.V1)(o,"admin-getApiStatus"),h=(0,n.V1)(o,"newsletter-generateNewsletterOnDemand");(0,n.V1)(o,"newsletter-publishNewsletter");let x=(0,n.V1)(o,"newsletter-getNewsletter"),g=(0,n.V1)(o,"newsletter-getNewsletters"),b=(0,n.V1)(o,"content-collectContentFromSources"),p=(0,n.V1)(o,"content-searchContentFromAI");(0,n.V1)(o,"content-getContent"),(0,n.V1)(o,"content-saveContent");let f=[{id:"dev-1",name:"Dev Source 1",url:"https://example.com/1",category:"news",active:!0},{id:"dev-2",name:"Dev Source 2",url:"https://example.com/2",category:"research",active:!0}],j=e=>!!(e&&e.startsWith("dev-admin-")),y=async e=>{try{return await i(e)}catch(t){if(console.warn("Firebase adminLogin error, using development fallback:",t),"admin123"===e.password){let e="dev-admin-"+Math.random().toString(36).substring(2,15);return{data:{success:!0,token:e}}}return{data:{success:!1,error:"Invalid password"}}}},N=async e=>{try{return await m(e)}catch(t){if(console.warn("Firebase getApiStatus error, using development fallback:",t),e.token&&j(e.token))return{data:{success:!0,status:{openRouter:{status:"ok",message:"Development mode - API simulated",quota:{used:25,limit:100,remaining:75}},firebase:{status:"ok",message:"Development mode - Firebase simulated",usage:{reads:120,writes:45,deletes:10}},email:{status:"ok",message:"Development mode - Email service simulated",quota:{used:250,limit:2e3,remaining:1750}}}}};return{data:{success:!1,error:"Unauthorized access"}}}},w=async e=>{try{return await d(e)}catch(t){if(console.warn("Firebase getContentSources error, using development fallback:",t),e.token&&j(e.token))return{data:{success:!0,sources:f}};return{data:{success:!1,error:"Unauthorized access"}}}},v=async e=>{try{return await u(e)}catch(t){if(console.warn("Firebase addContentSource error, using development fallback:",t),e.token&&j(e.token)){let t={id:"dev-"+Math.random().toString(36).substring(2,9),name:e.name,url:e.url,category:e.category||"news",active:!0};return f.push(t),{data:{success:!0,source:t}}}return{data:{success:!1,error:"Unauthorized access"}}}},S=async e=>{try{return await b(e)}catch(t){if(console.warn("Firebase collectContentFromSources error, using development fallback:",t),e.token&&j(e.token))return{data:{success:!0,message:"Content collection simulated in development mode",contentCount:5,sources:2}};return{data:{success:!1,error:"Unauthorized access"}}}},k=async e=>{try{return await p(e)}catch(t){if(console.warn("Firebase searchContentFromAI error, using development fallback:",t),e.token&&j(e.token)){await new Promise(e=>setTimeout(e,1500));let t=[{id:"dev-content-1",title:"Research on ".concat(e.query||"Geology"),source:"Development Source",url:"https://example.com/article1",publishedAt:new Date,summary:"This is a simulated summary about ".concat(e.query||"geoscience topics"," generated in development mode."),category:"research",interestScore:85},{id:"dev-content-2",title:"Latest News on ".concat(e.query||"Earth Sciences"),source:"Development Journal",url:"https://example.com/article2",publishedAt:new Date,summary:"Here's another simulated summary about ".concat(e.query||"geoscience"," for testing purposes."),category:"news",interestScore:72}];return{data:{success:!0,content:t,message:"AI search simulated in development mode"}}}return{data:{success:!1,error:"Unauthorized access"}}}},C=h,A=x,F=g;(0,n.V1)(o,"subscribers-addSubscriber")},7781:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var r=s(5893),a=s(7294),n=s(1163),c=s(9008),l=s.n(c),o=s(2947),i=s(5218),d=s(874),u=s(3692);function m(){let[e,t]=(0,a.useState)(!1),[s,c]=(0,a.useState)(!1),[m,h]=(0,a.useState)([]),[x,g]=(0,a.useState)(""),[b,p]=(0,a.useState)([]),[f,j]=(0,a.useState)([]),[y,N]=(0,a.useState)(["research","news"]),[w,v]=(0,a.useState)("list"),S=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("geobit_admin_token");if(!e){S.push("/admin");return}k()},[S]);let k=async()=>{try{let e=localStorage.getItem("geobit_admin_token"),t=await (0,i.qp)({token:e});t.data.success?(h(t.data.sources),j(t.data.sources.filter(e=>e.active).map(e=>e.id))):o.Am.error(t.data.error||"Failed to fetch sources")}catch(e){console.error("Error fetching sources:",e),o.Am.error("Failed to fetch content sources")}},C=async()=>{if(!e){t(!0),o.Am.info("Collecting content from selected sources...");try{let e=localStorage.getItem("geobit_admin_token");if(!e){o.Am.error("You must be logged in as an admin"),S.push("/admin");return}let s=m.filter(e=>f.includes(e.id));if(0===s.length){o.Am.warning("Please select at least one source"),t(!1);return}let r=await (0,i.Rr)({token:e,sourceIds:f});if(r.data.success)o.Am.success("Successfully collected ".concat(r.data.contentCount," items from ").concat(r.data.sources," sources"));else throw Error(r.data.error||"Failed to collect content")}catch(e){console.error("Error collecting content:",e),o.Am.error(e.message||"Failed to collect content")}finally{t(!1)}}},A=async e=>{if(e.preventDefault(),!s&&x.trim()){c(!0),o.Am.info("Searching for content using AI...");try{let e=localStorage.getItem("geobit_admin_token");if(!e){o.Am.error("You must be logged in as an admin"),S.push("/admin");return}let t=await (0,i.oq)({token:e,query:x,categories:y});if(t.data.success)p(t.data.content),o.Am.success("Found ".concat(t.data.content.length," articles matching your search"));else throw Error(t.data.error||"Failed to search for content")}catch(e){console.error("Error searching content:",e),o.Am.error(e.message||"Failed to search for content")}finally{c(!1)}}},F=e=>{y.includes(e)?N(y.filter(t=>t!==e)):N([...y,e])},_=e=>{f.includes(e)?j(f.filter(t=>t!==e)):j([...f,e])};return(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(l(),{children:[(0,r.jsx)("title",{children:"Content Collection - GeoBit Admin"}),(0,r.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Content Collection"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>v(e=>"list"===e?"grid":"list"),className:"flex items-center gap-1 text-sm bg-slate-200 hover:bg-slate-300 text-slate-700 py-1 px-3 rounded-md transition",children:"list"===w?"Grid View":"List View"}),(0,r.jsxs)("button",{onClick:k,className:"flex items-center gap-1 text-sm bg-slate-200 hover:bg-slate-300 text-slate-700 py-1 px-3 rounded-md transition",children:[(0,r.jsx)(u.Bw1,{size:14})," Refresh"]})]})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,r.jsx)(u.xaD,{className:"mr-2"})," Collect from Sources"]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-medium text-slate-700",children:"Select Sources"}),(0,r.jsx)("button",{onClick:()=>{f.length===m.length?j([]):j(m.map(e=>e.id))},className:"text-sm text-blue-600 hover:text-blue-800",children:f.length===m.length?"Deselect All":"Select All"})]}),(0,r.jsx)("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-md divide-y",children:0===m.length?(0,r.jsx)("div",{className:"p-4 text-gray-500 text-center",children:"No sources available"}):m.map(e=>(0,r.jsxs)("div",{className:"p-3 flex items-center hover:bg-gray-50",children:[(0,r.jsx)("input",{type:"checkbox",id:"source-".concat(e.id),checked:f.includes(e.id),onChange:()=>_(e.id),className:"mr-3 h-4 w-4 rounded text-blue-600"}),(0,r.jsxs)("label",{htmlFor:"source-".concat(e.id),className:"flex-1 flex items-center justify-between cursor-pointer",children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:e.name}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("research"===e.category?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:e.category})]})]},e.id))})]}),(0,r.jsx)("button",{onClick:C,disabled:e||0===f.length,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 disabled:opacity-50 flex items-center justify-center",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Bw1,{className:"mr-2 animate-spin"}),"Collecting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.bGz,{className:"mr-2"}),"Collect Content from Selected Sources"]})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,r.jsx)(u.jRj,{className:"mr-2"})," AI-Powered Search"]}),(0,r.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search-query",className:"block font-medium text-gray-700 mb-1",children:"Search Query"}),(0,r.jsx)("input",{id:"search-query",type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"E.g., Latest research on glaciology",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:s})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"block font-medium text-gray-700 mb-1",children:"Categories"}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("label",{className:"inline-flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:y.includes("research"),onChange:()=>F("research"),className:"h-4 w-4 rounded text-blue-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-700",children:"Research"})]}),(0,r.jsxs)("label",{className:"inline-flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:y.includes("news"),onChange:()=>F("news"),className:"h-4 w-4 rounded text-blue-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-700",children:"News"})]})]})]}),(0,r.jsx)("button",{type:"submit",disabled:s||!x.trim()||0===y.length,className:"w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 disabled:opacity-50 flex items-center justify-center",children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Bw1,{className:"mr-2 animate-spin"}),"Searching..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.jRj,{className:"mr-2"}),"Search"]})})]})]})]}),b.length>0&&(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:"Search Results"}),"list"===w?(0,r.jsx)("div",{className:"divide-y",children:b.map(e=>(0,r.jsxs)("div",{className:"py-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h3",{className:"font-bold text-gray-900",children:e.title}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("research"===e.category?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:e.category})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-2 text-sm",children:e.summary}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:[e.source," • ",new Date(e.publishedAt).toLocaleDateString()]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"flex items-center text-amber-600",children:["Interest Score: ",e.interestScore]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"flex items-center text-green-600 hover:text-green-800",children:(0,r.jsx)(u._rq,{size:18})}),(0,r.jsx)("button",{className:"flex items-center text-red-600 hover:text-red-800",children:(0,r.jsx)(u.$Rx,{size:18})})]})]})]})]},e.id))}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h3",{className:"font-bold text-gray-900",children:e.title}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("research"===e.category?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:e.category})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-2 text-sm",children:e.summary}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:[e.source," • ",new Date(e.publishedAt).toLocaleDateString()]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-amber-600",children:["Score: ",e.interestScore]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"text-green-600 hover:text-green-800",children:(0,r.jsx)(u._rq,{size:16})}),(0,r.jsx)("button",{className:"text-red-600 hover:text-red-800",children:(0,r.jsx)(u.$Rx,{size:16})})]})]})]})]},e.id))})]})]})}}},function(e){e.O(0,[16,814,692,840,774,888,179],function(){return e(e.s=1993)}),_N_E=e.O()}]);