(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{3133:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/analytics",function(){return s(1473)}])},874:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(5893),r=s(1163),n=s(1664),c=s.n(n);function l(e){let{children:t}=e,s=(0,r.useRouter)(),n=e=>!!("/admin/dashboard"===e&&"/admin/dashboard"===s.pathname||"/admin/dashboard"!==e&&s.pathname.startsWith(e));return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-100 flex",children:[(0,a.jsxs)("aside",{className:"w-64 bg-slate-800 text-white",children:[(0,a.jsx)("div",{className:"p-4 border-b border-slate-700",children:(0,a.jsx)("h1",{className:"text-xl font-bold",children:"GeoBit Admin"})}),(0,a.jsx)("nav",{className:"p-4",children:(0,a.jsx)("ul",{className:"space-y-2",children:[{href:"/admin/dashboard",label:"Dashboard"},{href:"/admin/newsletters",label:"Newsletters"},{href:"/admin/sources",label:"Content Sources"},{href:"/admin/subscribers",label:"Subscribers"}].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(c(),{href:e.href,className:"block px-4 py-2 rounded-md transition duration-200 ".concat(n(e.href)?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-700"),children:e.label})},e.href))})}),(0,a.jsx)("div",{className:"p-4 mt-auto border-t border-slate-700",children:(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("geobit_admin_token"),s.push("/admin")},className:"block w-full px-4 py-2 text-left text-slate-300 hover:bg-slate-700 rounded-md transition duration-200",children:"Logout"})})]}),(0,a.jsx)("main",{className:"flex-1 p-8 overflow-auto",children:t})]})}},5218:function(e,t,s){"use strict";s.d(t,{$g:function(){return v},C7:function(){return C},Rr:function(){return k},bk:function(){return y},jA:function(){return w},kM:function(){return R},oq:function(){return M},ou:function(){return j},qp:function(){return N},sC:function(){return S}});var a=s(3977),r=s(9828),n=s(7004),c=s(3059);let l=(0,a.C6)().length?(0,a.C6)()[0]:(0,a.ZF)({apiKey:"AIzaSyDvpreQ684CJaRl0dfbhR9i_IDKz58JfMk",authDomain:"geobit-959c9.firebaseapp.com",projectId:"geobit-959c9",storageBucket:"geobit-959c9.firebasestorage.app",messagingSenderId:"518824678195",appId:"1:518824678195:web:dbd647fbe88edfd4fa6446",measurementId:"G-26LPTBX5H4"});(0,r.ad)(l);let o=(0,n.$C)(l);(0,c.Gb)().then(e=>{e&&(0,c.IH)(l)}).catch(e=>{console.error("Analytics error:",e)});let i=(0,n.V1)(o,"admin-adminLogin"),d=(0,n.V1)(o,"admin-getContentSources"),m=(0,n.V1)(o,"admin-addContentSource");(0,n.V1)(o,"admin-updateContentSource"),(0,n.V1)(o,"admin-deleteContentSource"),(0,n.V1)(o,"admin-getSubscribers");let u=(0,n.V1)(o,"admin-getApiStatus"),h=(0,n.V1)(o,"newsletter-generateNewsletterOnDemand");(0,n.V1)(o,"newsletter-publishNewsletter");let x=(0,n.V1)(o,"newsletter-getNewsletter"),g=(0,n.V1)(o,"newsletter-getNewsletters"),b=(0,n.V1)(o,"content-collectContentFromSources"),p=(0,n.V1)(o,"content-searchContentFromAI");(0,n.V1)(o,"content-getContent"),(0,n.V1)(o,"content-saveContent");let f=[{id:"dev-1",name:"Dev Source 1",url:"https://example.com/1",category:"news",active:!0},{id:"dev-2",name:"Dev Source 2",url:"https://example.com/2",category:"research",active:!0}],j=e=>!!(e&&e.startsWith("dev-admin-")),v=async e=>{try{return await i(e)}catch(t){if(console.warn("Firebase adminLogin error, using development fallback:",t),"admin123"===e.password){let e="dev-admin-"+Math.random().toString(36).substring(2,15);return{data:{success:!0,token:e}}}return{data:{success:!1,error:"Invalid password"}}}},y=async e=>{try{return await u(e)}catch(t){if(console.warn("Firebase getApiStatus error, using development fallback:",t),e.token&&j(e.token))return{data:{success:!0,status:{openRouter:{status:"ok",message:"Development mode - API simulated",quota:{used:25,limit:100,remaining:75}},firebase:{status:"ok",message:"Development mode - Firebase simulated",usage:{reads:120,writes:45,deletes:10}},email:{status:"ok",message:"Development mode - Email service simulated",quota:{used:250,limit:2e3,remaining:1750}}}}};return{data:{success:!1,error:"Unauthorized access"}}}},N=async e=>{try{return await d(e)}catch(t){if(console.warn("Firebase getContentSources error, using development fallback:",t),e.token&&j(e.token))return{data:{success:!0,sources:f}};return{data:{success:!1,error:"Unauthorized access"}}}},w=async e=>{try{return await m(e)}catch(t){if(console.warn("Firebase addContentSource error, using development fallback:",t),e.token&&j(e.token)){let t={id:"dev-"+Math.random().toString(36).substring(2,9),name:e.name,url:e.url,category:e.category||"news",active:!0};return f.push(t),{data:{success:!0,source:t}}}return{data:{success:!1,error:"Unauthorized access"}}}},k=async e=>{try{return await b(e)}catch(t){if(console.warn("Firebase collectContentFromSources error, using development fallback:",t),e.token&&j(e.token))return{data:{success:!0,message:"Content collection simulated in development mode",contentCount:5,sources:2}};return{data:{success:!1,error:"Unauthorized access"}}}},M=async e=>{try{return await p(e)}catch(t){if(console.warn("Firebase searchContentFromAI error, using development fallback:",t),e.token&&j(e.token)){await new Promise(e=>setTimeout(e,1500));let t=[{id:"dev-content-1",title:"Research on ".concat(e.query||"Geology"),source:"Development Source",url:"https://example.com/article1",publishedAt:new Date,summary:"This is a simulated summary about ".concat(e.query||"geoscience topics"," generated in development mode."),category:"research",interestScore:85},{id:"dev-content-2",title:"Latest News on ".concat(e.query||"Earth Sciences"),source:"Development Journal",url:"https://example.com/article2",publishedAt:new Date,summary:"Here's another simulated summary about ".concat(e.query||"geoscience"," for testing purposes."),category:"news",interestScore:72}];return{data:{success:!0,content:t,message:"AI search simulated in development mode"}}}return{data:{success:!1,error:"Unauthorized access"}}}},C=h,R=x,S=g;(0,n.V1)(o,"subscribers-addSubscriber")},1473:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var a=s(5893),r=s(7294),n=s(1163),c=s(9008),l=s.n(c),o=s(2947),i=s(3692),d=s(874),m=s(5218);function u(){let[e,t]=(0,r.useState)(!0),[s,c]=(0,r.useState)(null),[u,h]=(0,r.useState)("30d"),x=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("geobit_admin_token");if(!e){x.push("/admin");return}g()},[x,u]);let g=async()=>{t(!0);try{let e=localStorage.getItem("geobit_admin_token");if(await new Promise(e=>setTimeout(e,1e3)),(0,m.ou)(e)){let e=b(u);c(e)}else o.Am.error("Unauthorized access"),x.push("/admin")}catch(e){console.error("Error fetching analytics:",e),o.Am.error("Failed to fetch analytics data")}finally{t(!1)}},b=e=>{let t,s;let a=new Date,r=[],n=[],c=[],l=[];switch(e){case"7d":t=7,s=1;break;case"30d":default:t=30,s=1;break;case"90d":t=90,s=7;break;case"1y":t=365,s=30}let o=200+Math.floor(100*Math.random()),i=30+Math.floor(10*Math.random()),d=5+Math.floor(5*Math.random());for(let e=t;e>=0;e-=s){let m=new Date(a);m.setDate(m.getDate()-e),1===s?r.push(m.toLocaleDateString(void 0,{month:"short",day:"numeric"})):7===s?r.push("Week ".concat(Math.ceil((t-e)/7))):r.push(m.toLocaleDateString(void 0,{month:"short",year:"numeric"}));let u=10*Math.random()-2;o+=Math.max(0,Math.floor(u)),n.push(o);let h=10*Math.random()-5,x=4*Math.random()-2;c.push(Math.max(15,Math.min(70,i+h))),l.push(Math.max(1,Math.min(20,d+x)))}let m=[{category:"Research Papers",percentage:35+Math.floor(10*Math.random())},{category:"Industry News",percentage:25+Math.floor(10*Math.random())},{category:"Technological Advancements",percentage:20+Math.floor(5*Math.random())},{category:"Field Studies",percentage:15+Math.floor(5*Math.random())},{category:"Other",percentage:5+Math.floor(3*Math.random())}],u=m.reduce((e,t)=>e+t.percentage,0);m.forEach(e=>{e.percentage=Math.round(e.percentage/u*100)});let h=o,x=c.reduce((e,t)=>e+t,0)/c.length,g=l.reduce((e,t)=>e+t,0)/l.length,b={};if("7d"===e)b.subscribers=Math.floor((n[n.length-1]-n[0])/n[0]*100),b.openRate=((c[c.length-1]-c[0])/c[0]*100).toFixed(1),b.clickRate=((l[l.length-1]-l[0])/l[0]*100).toFixed(1);else{let e=Math.floor(n.length/2),t=n.slice(0,e),s=n.slice(e),a=t.reduce((e,t)=>e+t,0)/t.length,r=s.reduce((e,t)=>e+t,0)/s.length;b.subscribers=Math.floor((r-a)/a*100);let o=c.slice(0,e).reduce((e,t)=>e+t,0)/t.length,i=c.slice(e).reduce((e,t)=>e+t,0)/s.length;b.openRate=((i-o)/o*100).toFixed(1);let d=l.slice(0,e).reduce((e,t)=>e+t,0)/t.length,m=l.slice(e).reduce((e,t)=>e+t,0)/s.length;b.clickRate=((m-d)/d*100).toFixed(1)}return{summary:{currentSubscribers:h,avgOpenRate:x,avgClickRate:g,growth:b},charts:{labels:r,subscriberData:n,openRateData:c,clickRateData:l},contentPreferences:m,popularContent:[{title:"Recent Advancements in Seismic Monitoring",openRate:65+Math.floor(10*Math.random()),clickRate:32+Math.floor(10*Math.random())},{title:"New Research on Climate Impact on Geological Formations",openRate:58+Math.floor(10*Math.random()),clickRate:27+Math.floor(10*Math.random())},{title:"Breakthrough in Mineral Extraction Technologies",openRate:52+Math.floor(10*Math.random()),clickRate:24+Math.floor(10*Math.random())},{title:"Understanding Deep Ocean Geological Processes",openRate:49+Math.floor(10*Math.random()),clickRate:20+Math.floor(10*Math.random())}]}};return(0,a.jsxs)(d.Z,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Analytics - GeoBit Admin"}),(0,a.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Analytics"}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.vlc,{className:"text-gray-400 mr-2"}),(0,a.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"7d",children:"Last 7 Days"}),(0,a.jsx)("option",{value:"30d",children:"Last 30 Days"}),(0,a.jsx)("option",{value:"90d",children:"Last 90 Days"}),(0,a.jsx)("option",{value:"1y",children:"Last Year"})]})]}),(0,a.jsxs)("button",{onClick:g,disabled:e,className:"flex items-center gap-2 bg-slate-200 hover:bg-slate-300 text-slate-700 py-2 px-4 rounded-md transition",children:[(0,a.jsx)(i.Bw1,{className:e?"animate-spin":""}),e?"Loading...":"Refresh"]}),(0,a.jsxs)("button",{onClick:()=>{if(!s)return;let e=s.summary,t=["Metric,Value,Growth",["Subscribers",e.currentSubscribers,"".concat(e.growth.subscribers,"%")].join(","),["Avg. Open Rate","".concat(e.avgOpenRate.toFixed(1),"%"),"".concat(e.growth.openRate,"%")].join(","),["Avg. Click Rate","".concat(e.avgClickRate.toFixed(1),"%"),"".concat(e.growth.clickRate,"%")].join(","),[],["Content Preferences","",""],["Category","Percentage",""],...s.contentPreferences.map(e=>[e.category,"".concat(e.percentage,"%"),""].join(","))].join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),n=document.createElement("a");n.setAttribute("href",r),n.setAttribute("download","geobit-analytics-".concat(new Date().toISOString().slice(0,10),".csv")),document.body.appendChild(n),n.click(),document.body.removeChild(n)},disabled:e||!s,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition disabled:opacity-50",children:[(0,a.jsx)(i._hL,{}),"Export"]})]})]}),e?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,a.jsx)(i.Bw1,{className:"inline-block animate-spin text-blue-600 mb-3",size:24}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading analytics data..."})]}):s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-full",children:(0,a.jsx)(i.WY8,{className:"text-blue-600",size:24})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Subscribers"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Total subscribers"})]})]}),(0,a.jsxs)("div",{className:"flex items-center ".concat(s.summary.growth.subscribers>=0?"text-green-600":"text-red-600"),children:[(0,a.jsx)(i.QqI,{className:"mr-1"}),(0,a.jsxs)("span",{children:[s.summary.growth.subscribers,"%"]})]})]}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:s.summary.currentSubscribers.toLocaleString()})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,a.jsx)(i.Imn,{className:"text-green-600",size:24})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Open Rate"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Average open rate"})]})]}),(0,a.jsxs)("div",{className:"flex items-center ".concat(s.summary.growth.openRate>=0?"text-green-600":"text-red-600"),children:[(0,a.jsx)(i.QqI,{className:"mr-1"}),(0,a.jsxs)("span",{children:[s.summary.growth.openRate,"%"]})]})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:[s.summary.avgOpenRate.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-purple-100 rounded-full",children:(0,a.jsx)(i.orK,{className:"text-purple-600",size:24})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Click Rate"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Average click rate"})]})]}),(0,a.jsxs)("div",{className:"flex items-center ".concat(s.summary.growth.clickRate>=0?"text-green-600":"text-red-600"),children:[(0,a.jsx)(i.QqI,{className:"mr-1"}),(0,a.jsxs)("span",{children:[s.summary.growth.clickRate,"%"]})]})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:[s.summary.avgClickRate.toFixed(1),"%"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(i.QqI,{className:"mr-2"})," Subscriber Growth"]}),(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Charts would be implemented using a library like recharts or Chart.js"})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(i.orK,{className:"mr-2"})," Engagement Metrics"]}),(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Charts would be implemented using a library like recharts or Chart.js"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(i.CFv,{className:"mr-2"})," Content Preferences"]}),(0,a.jsx)("div",{children:s.contentPreferences.map((e,t)=>(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:e.category}),(0,a.jsxs)("span",{className:"text-gray-500",children:[e.percentage,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.percentage,"%")}})})]},t))})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[(0,a.jsx)(i.orK,{className:"mr-2"})," Top Performing Content"]}),(0,a.jsx)("div",{className:"space-y-4",children:s.popularContent.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 border border-gray-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:e.title}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Open Rate"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"text-lg font-bold mr-2",children:[e.openRate,"%"]}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(e.openRate,"%")}})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Click Rate"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"text-lg font-bold mr-2",children:[e.clickRate,"%"]}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"".concat(e.clickRate,"%")}})})]})]})]})]},t))})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("p",{className:"text-blue-700 text-sm",children:[(0,a.jsx)("strong",{children:"Development Mode:"})," In production, the charts would be implemented using libraries like recharts, Chart.js or D3.js. The data would be fetched from Firebase and actual analytics services."]})})]}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center text-gray-600",children:"Failed to load analytics data."})]})}}},function(e){e.O(0,[16,814,692,840,774,888,179],function(){return e(e.s=3133)}),_N_E=e.O()}]);