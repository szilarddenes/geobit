(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733],{1424:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sources/search",function(){return r(9283)}])},874:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var s=r(5893),a=r(1163),n=r(1664),o=r.n(n);function c(e){let{children:t}=e,r=(0,a.useRouter)(),n=e=>!!("/admin/dashboard"===e&&"/admin/dashboard"===r.pathname||"/admin/dashboard"!==e&&r.pathname.startsWith(e));return(0,s.jsxs)("div",{className:"min-h-screen bg-slate-100 flex",children:[(0,s.jsxs)("aside",{className:"w-64 bg-slate-800 text-white",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-700",children:(0,s.jsx)("h1",{className:"text-xl font-bold",children:"GeoBit Admin"})}),(0,s.jsx)("nav",{className:"p-4",children:(0,s.jsx)("ul",{className:"space-y-2",children:[{href:"/admin/dashboard",label:"Dashboard"},{href:"/admin/newsletters",label:"Newsletters"},{href:"/admin/sources",label:"Content Sources"},{href:"/admin/subscribers",label:"Subscribers"}].map(e=>(0,s.jsx)("li",{children:(0,s.jsx)(o(),{href:e.href,className:"block px-4 py-2 rounded-md transition duration-200 ".concat(n(e.href)?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-700"),children:e.label})},e.href))})}),(0,s.jsx)("div",{className:"p-4 mt-auto border-t border-slate-700",children:(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("geobit_admin_token"),r.push("/admin")},className:"block w-full px-4 py-2 text-left text-slate-300 hover:bg-slate-700 rounded-md transition duration-200",children:"Logout"})})]}),(0,s.jsx)("main",{className:"flex-1 p-8 overflow-auto",children:t})]})}},5218:function(e,t,r){"use strict";r.d(t,{$g:function(){return v},C7:function(){return A},Rr:function(){return k},bk:function(){return w},jA:function(){return j},kM:function(){return C},oq:function(){return S},ou:function(){return y},qp:function(){return N},sC:function(){return _}});var s=r(3977),a=r(9828),n=r(7004),o=r(3059);let c=(0,s.C6)().length?(0,s.C6)()[0]:(0,s.ZF)({apiKey:"AIzaSyDvpreQ684CJaRl0dfbhR9i_IDKz58JfMk",authDomain:"geobit-959c9.firebaseapp.com",projectId:"geobit-959c9",storageBucket:"geobit-959c9.firebasestorage.app",messagingSenderId:"518824678195",appId:"1:518824678195:web:dbd647fbe88edfd4fa6446",measurementId:"G-26LPTBX5H4"});(0,a.ad)(c);let i=(0,n.$C)(c);(0,o.Gb)().then(e=>{e&&(0,o.IH)(c)}).catch(e=>{console.error("Analytics error:",e)});let l=(0,n.V1)(i,"admin-adminLogin"),d=(0,n.V1)(i,"admin-getContentSources"),u=(0,n.V1)(i,"admin-addContentSource");(0,n.V1)(i,"admin-updateContentSource"),(0,n.V1)(i,"admin-deleteContentSource"),(0,n.V1)(i,"admin-getSubscribers");let m=(0,n.V1)(i,"admin-getApiStatus"),h=(0,n.V1)(i,"newsletter-generateNewsletterOnDemand");(0,n.V1)(i,"newsletter-publishNewsletter");let p=(0,n.V1)(i,"newsletter-getNewsletter"),b=(0,n.V1)(i,"newsletter-getNewsletters"),g=(0,n.V1)(i,"content-collectContentFromSources"),f=(0,n.V1)(i,"content-searchContentFromAI");(0,n.V1)(i,"content-getContent"),(0,n.V1)(i,"content-saveContent");let x=[{id:"dev-1",name:"Dev Source 1",url:"https://example.com/1",category:"news",active:!0},{id:"dev-2",name:"Dev Source 2",url:"https://example.com/2",category:"research",active:!0}],y=e=>!!(e&&e.startsWith("dev-admin-")),v=async e=>{try{return await l(e)}catch(t){if(console.warn("Firebase adminLogin error, using development fallback:",t),"admin123"===e.password){let e="dev-admin-"+Math.random().toString(36).substring(2,15);return{data:{success:!0,token:e}}}return{data:{success:!1,error:"Invalid password"}}}},w=async e=>{try{return await m(e)}catch(t){if(console.warn("Firebase getApiStatus error, using development fallback:",t),e.token&&y(e.token))return{data:{success:!0,status:{openRouter:{status:"ok",message:"Development mode - API simulated",quota:{used:25,limit:100,remaining:75}},firebase:{status:"ok",message:"Development mode - Firebase simulated",usage:{reads:120,writes:45,deletes:10}},email:{status:"ok",message:"Development mode - Email service simulated",quota:{used:250,limit:2e3,remaining:1750}}}}};return{data:{success:!1,error:"Unauthorized access"}}}},N=async e=>{try{return await d(e)}catch(t){if(console.warn("Firebase getContentSources error, using development fallback:",t),e.token&&y(e.token))return{data:{success:!0,sources:x}};return{data:{success:!1,error:"Unauthorized access"}}}},j=async e=>{try{return await u(e)}catch(t){if(console.warn("Firebase addContentSource error, using development fallback:",t),e.token&&y(e.token)){let t={id:"dev-"+Math.random().toString(36).substring(2,9),name:e.name,url:e.url,category:e.category||"news",active:!0};return x.push(t),{data:{success:!0,source:t}}}return{data:{success:!1,error:"Unauthorized access"}}}},k=async e=>{try{return await g(e)}catch(t){if(console.warn("Firebase collectContentFromSources error, using development fallback:",t),e.token&&y(e.token))return{data:{success:!0,message:"Content collection simulated in development mode",contentCount:5,sources:2}};return{data:{success:!1,error:"Unauthorized access"}}}},S=async e=>{try{return await f(e)}catch(t){if(console.warn("Firebase searchContentFromAI error, using development fallback:",t),e.token&&y(e.token)){await new Promise(e=>setTimeout(e,1500));let t=[{id:"dev-content-1",title:"Research on ".concat(e.query||"Geology"),source:"Development Source",url:"https://example.com/article1",publishedAt:new Date,summary:"This is a simulated summary about ".concat(e.query||"geoscience topics"," generated in development mode."),category:"research",interestScore:85},{id:"dev-content-2",title:"Latest News on ".concat(e.query||"Earth Sciences"),source:"Development Journal",url:"https://example.com/article2",publishedAt:new Date,summary:"Here's another simulated summary about ".concat(e.query||"geoscience"," for testing purposes."),category:"news",interestScore:72}];return{data:{success:!0,content:t,message:"AI search simulated in development mode"}}}return{data:{success:!1,error:"Unauthorized access"}}}},A=h,C=p,_=b;(0,n.V1)(i,"subscribers-addSubscriber")},9283:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var s=r(5893),a=r(7294),n=r(1163),o=r(9008),c=r.n(o),i=r(2947);async function l(e){try{let r=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat("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"),"Content-Type":"application/json","HTTP-Referer":window.location.origin,"X-Title":"GeoBit Newsletter"},body:JSON.stringify({model:"perplexity/sonar-small-online",fallbacks:["perplexity/sonar-small-chat","anthropic/claude-3-haiku-20240307"],messages:[{role:"system",content:"You are a geoscience research assistant that finds relevant, recent scientific articles. Return results in JSON format."},{role:"user",content:'Find 3-5 recent, high-quality scientific articles about "'.concat(e,'" in the field of geoscience. For each article, provide the title, authors, publication date, URL, and a brief description of key findings. Format your response as a JSON array of objects with keys: title, authors, date, url, and description.')}],max_tokens:800,tools:[{type:"web_search"}],tool_choice:{type:"web_search"},response_format:{type:"json_object"}})}),s=await r.json();if(!r.ok){var t;throw Error((null===(t=s.error)||void 0===t?void 0:t.message)||"Failed to search for articles")}let a=s.choices[0].message.content;try{let e=JSON.parse(a);return Array.isArray(e)?e:e.articles||[]}catch(e){return console.error("Failed to parse article search results:",e),[]}}catch(e){throw console.error("Error searching for geoscience articles:",e),e}}function d(e){let{onArticleSelect:t}=e,[r,n]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),[i,d]=(0,a.useState)([]),[u,m]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),b=async e=>{if(e.preventDefault(),r.trim()&&!o){c(!0),m(""),d([]);try{let e=await l(r);d(e),p("perplexity/sonar-small-online")}catch(e){console.error("Error searching for articles:",e),m("Failed to search for articles. Please try again.")}finally{c(!1)}}},g=e=>{t&&t(e)};return(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Geoscience Article Search"}),(0,s.jsxs)("form",{onSubmit:b,className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),className:"flex-1 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm p-2 border",placeholder:"Search for geoscience articles...",disabled:o}),(0,s.jsx)("button",{type:"submit",disabled:o||!r.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 disabled:opacity-50",children:o?"Searching...":"Search"})]}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Powered by Perplexity web search - find recent geoscience articles on any topic"})]}),u&&(0,s.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded-md mb-4",children:u}),h&&i.length>0&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["Search performed using ",h]}),i.length>0?(0,s.jsx)("div",{className:"space-y-4",children:i.map((e,t)=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>g(e),children:[(0,s.jsx)("h4",{className:"font-medium text-blue-600",children:e.title}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.authors," • ",e.date]}),(0,s.jsx)("p",{className:"text-sm mt-2",children:e.description}),(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:text-blue-700 mt-2 inline-block",onClick:e=>e.stopPropagation(),children:"View Original"})]},t))}):r&&!o?(0,s.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No articles found. Try a different search term."}):null]})}var u=r(874),m=r(5218);function h(){let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(!1),l=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("geobit_admin_token");e||l.push("/admin")},[l]);let h=r=>{let s=[...e];s.splice(r,1),t(s),i.Am.info("Article removed from selection")},p=async()=>{if(0!==e.length&&!r){o(!0);try{let r=localStorage.getItem("geobit_admin_token");if(!r){i.Am.error("You must be logged in as an admin to perform this action"),l.push("/admin");return}let s=await Promise.all(e.map(e=>(0,m.jA)({token:r,name:e.title,url:e.url,category:"article"}))),a=s.filter(e=>e.data.success).length;a>0?(i.Am.success("".concat(a," articles added to content sources")),t([]),l.push("/admin/sources")):i.Am.error("Failed to add articles to sources")}catch(e){console.error("Error adding articles to sources:",e),i.Am.error("Failed to add articles to sources. Please try again.")}finally{o(!1)}}};return(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(c(),{children:[(0,s.jsx)("title",{children:"Article Search - GeoBit Admin"}),(0,s.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Search Geoscience Articles"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>l.push("/admin/sources"),className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition duration-200",children:"Back to Sources"}),(0,s.jsx)("button",{onClick:p,disabled:0===e.length||r,className:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 disabled:opacity-50",children:r?"Adding...":"Add ".concat(e.length," Articles to Sources")})]})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)(d,{onArticleSelect:r=>{let s=e.some(e=>e.url===r.url);s?i.Am.info("Article already in your selection"):(t([...e,r]),i.Am.success("Article added to selection"))}})}),(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Selected Articles ",e.length>0&&"(".concat(e.length,")")]}),0===e.length?(0,s.jsx)("p",{className:"text-center text-gray-500 py-6",children:"No articles selected. Search and click on articles to add them here."}):(0,s.jsx)("div",{className:"space-y-4",children:e.map((e,t)=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 relative",children:[(0,s.jsx)("button",{onClick:()=>h(t),className:"absolute top-2 right-2 text-red-500 hover:text-red-700",children:"✕"}),(0,s.jsx)("h4",{className:"font-medium pr-6",children:e.title}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.authors," • ",e.date]}),(0,s.jsx)("p",{className:"text-sm mt-2",children:e.description}),(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:text-blue-700 mt-2 inline-block",children:"View Original"})]},t))})]})]})]})}}},function(e){e.O(0,[16,814,840,774,888,179],function(){return e(e.s=1424)}),_N_E=e.O()}]);